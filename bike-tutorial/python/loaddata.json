{
    "when": [
      {
        "and": [
          {
            "get": [
              [
                {
                  "as": [
                    {
                      "@value": "Start station"
                    },
                    "v:Start_Station"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "End station"
                    },
                    "v:End_Station"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "Start date"
                    },
                    "v:Start_Time"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "End date"
                    },
                    "v:End_Time"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "Duration"
                    },
                    "v:Duration"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "Start station number"
                    },
                    "v:Start_ID"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "End station number"
                    },
                    "v:End_ID"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "Bike number"
                    },
                    "v:Bike"
                  ]
                },
                {
                  "as": [
                    {
                      "@value": "Member type"
                    },
                    "v:Member_Type"
                  ]
                }
              ],
              {
                "remote": [
                  "https://terminusdb.com/t/data/bikeshare/201812-capitalbikeshare-tripdata.csv"
                ]
              }
            ]
          },
          {
            "idgen": [
              "doc:Journey",
              {
                "list": [
                  "v:Start_ID",
                  "v:Start_Time",
                  "v:Bike"
                ]
              },
              "v:Journey_ID"
            ]
          },
          {
            "idgen": [
              "doc:Station",
              {
                "list": [
                  "v:Start_ID"
                ]
              },
              "v:Start_Station_URL"
            ]
          },
          {
            "idgen": [
              "doc:Bicycle",
              {
                "list": [
                  "v:Bike"
                ]
              },
              "v:Bike_URL"
            ]
          },
          {
            "typecast": [
              "v:Bike",
              "xsd:string",
              "v:Bike_Label"
            ]
          },
          {
            "typecast": [
              "v:Duration",
              "xsd:integer",
              "v:Duration_Cast"
            ]
          },
          {
            "typecast": [
              "v:Start_Time",
              "xsd:dateTime",
              "v:Start_Time_Cast"
            ]
          },
          {
            "typecast": [
              "v:End_Time",
              "xsd:dateTime",
              "v:End_Time_Cast"
            ]
          },
          {
            "idgen": [
              "doc:Station",
              {
                "list": [
                  "v:End_ID"
                ]
              },
              "v:End_Station_URL"
            ]
          },
          {
            "concat": [
              {
                "list": [
                  {
                    "@value": "Bike ",
                    "@type": "xsd:string"
                  },
                  "v:Bike_Label",
                  {
                    "@value": " start at ",
                    "@type": "xsd:string"
                  },
                  "v:Start_Station",
                  {
                    "@value": " at ",
                    "@type": "xsd:string"
                  },
                  "v:Start_Time"
                ]
              },
              "v:Journey_Label"
            ]
          }
        ]
      },
      {
        "and": [
          {
            "add_triple": [
              "v:Journey_ID",
              "rdf:type",
              "scm:Journey"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:start_time",
              "v:Start_Time_Cast"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:end_time",
              "v:End_Time_Cast"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:duration",
              "v:Duration_Cast"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:start_station",
              "v:Start_Station_URL"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:end_station",
              "v:End_Station_URL"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "rdfs:label",
              "v:Journey_Label"
            ]
          },
          {
            "add_triple": [
              "v:Journey_ID",
              "scm:journey_bicycle",
              "v:Bike_URL"
            ]
          },
          {
            "add_triple": [
              "v:Start_Station_URL",
              "rdfs:label",
              "v:Start_Station"
            ]
          },
          {
            "add_triple": [
              "v:Start_Station_URL",
              "rdf:type",
              "scm:Station"
            ]
          },
          {
            "add_triple": [
              "v:End_Station_URL",
              "rdf:type",
              "scm:Station"
            ]
          },
          {
            "add_triple": [
              "v:End_Station_URL",
              "rdfs:label",
              "v:End_Station"
            ]
          },
          {
            "add_triple": [
              "v:Bike_URL",
              "rdf:type",
              "scm:Bicycle"
            ]
          },
          {
            "add_triple": [
              "v:Bike_URL",
              "rdfs:label",
              "v:Bike_Label"
            ]
          }
        ]
      }
    ]
  }